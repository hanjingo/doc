[TOC]

# 唯一ID的生成



## 1 数据库自增

利用数据库的主键ID插入时自增特性，来获得唯一的ID；

### 缺点

- 依赖于数据库，当数据库不可用时失效；
- ID一致性难以保证，数据库主从切换时不一致可能会导致ID重复；
- ID生成的性能瓶颈在书据库的性能，每次ID生成都需要去访问数据库。

### 优化

1. 可以采取分段号的方式，通过集群来生成ID；



## 2 snow_flake算法

SnowFlake算法是Twitter开源的分布式ID生成算法；其核心思想就是：使用一个64bit的long型数字作为全局唯一ID；其结构如下：

| 保留(统一为0) | 时间戳（毫秒级） | 机器ID | 自增  |
| ------------- | ---------------- | ------ | ----- |
| 1bit          | 41bit            | 10bit  | 12bit |

### 缺点

- 依赖于机器时钟，如果机器始终回拨，会导致发号重复或者服务处于不可用状态；

