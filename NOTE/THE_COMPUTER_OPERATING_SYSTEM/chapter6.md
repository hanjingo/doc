# 第六章 文件管理

[TOC]



## 1.文件类型
* 按用途：系统文件，用户文件，库文件；
* 按数据形式：源文件，目标文件，可执行文件；
* 按存取属性：只执行文件，只读文件，读写文件；
* 按组织形式：普通文件，目录文件，特殊文件；



## 2.文件逻辑结构

结构文件：  
1. 顺序文件；
2. 索引文件；
3. 索引顺序文件；

无结构文件：
1. 流文件；



## 3.哈希文件

可利用算法将链转化为文件地址；



## 4.外存分配

1. 连续分配；
2. 链接分配：1.隐式分配， 2.显式链接；
3. 索引分配：1.单级索引， 2.多级索引， 3.混合索引；



## 5.文件目录

1. 目录结构：

   单级：
| 文件名 | 物理地址 | 文件说明 | 状态位 |
| ------ | -------- | -------- | ------ |
|        |          |          |        |

两级：  

多级：采用树结构。  

相对路径：从当前路径开始查找； 
绝对路径：从根目录开始查找;  



## 6.文件存储空间的管理

1. 空闲表法；
2. 空闲链表发；



## 7.磁盘容错

1. `SFT-1<第一级容错技术>`：

   - 双份目录和双份文件分配表；

   - 热修复重定向；

   - 写后读校验方式；

2. `SFT-2<第二级容错技术>`：

   磁盘镜像:

   ```mermaid
   graph LR
   A[主机]-->B[磁盘控制器]-->C1[磁盘驱动器]
   B-->C2[磁盘驱动器]
   ```

   磁盘双工：

   ```mermaid
   graph LR
   A[主机]-->B1[磁盘控制器]-->C1[磁盘驱动器]
   A[主机]-->B2[磁盘控制器]-->C2[磁盘驱动器]
   ```

   

## 8.并发
* 互斥性：只允许一个对象对其进行读和写。
* 共享锁：允许多个对象读，不允许对象写。



## 9.数据一致性
1. 重复文件的一致性；
2. 盘块号一致性：对比空闲盘块和数据盘块；
3. 连接数一致性；