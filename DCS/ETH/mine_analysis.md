# 以太坊(ETH)挖矿可行性分析



## 参考

- [维基百科-以太坊介绍](https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E5%9D%8A)
- [以太坊挖矿难度调整算法详解](https://zhuanlan.zhihu.com/p/344237325)
- [挖矿收益计算网站-whattomine](https://whattomine.com/)



## 前提

### 以太坊介绍

**以太坊**（Ethereum）是一个[开源](https://zh.wikipedia.org/wiki/开源)的有[智能合约](https://zh.wikipedia.org/wiki/智能合约)功能的公共[区块链](https://zh.wikipedia.org/wiki/区块链)平台。通过其专用[加密货币](https://zh.wikipedia.org/wiki/加密货币)[以太币](https://zh.wikipedia.org/wiki/以太币)来处理[点对点](https://zh.wikipedia.org/wiki/点对点)合约；

**以太币**是目前市值（约5000亿美金，[参考](https://finance.sina.com.cn/blockchain/roll/2021-05-14/doc-ikmxzfmm2384211.shtml#:~:text=%E6%8D%AECoinTelegraph%E6%8A%A5%E9%81%93%EF%BC%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A,%E5%B9%B4%E9%9B%B610%E4%B8%AA%E6%9C%88%E3%80%82)）第二高的加密货币，仅次于比特币（bitcoin），不存在项目方跑路的可能；

以太坊挖矿效果受算力和挖矿难度影响；在挖矿难度不变时，算力越大，挖的以太币越多；在算力不变时，挖矿难度越大，挖的以太币越少；

### 算力

指计算机每秒可执行哈希运算的次数，也称为哈希率（hashrate）。是衡量矿机挖矿能力的一项重要指标。

算力单位：

- 1 H/s = 每秒可执行一次哈希运算
- 1 KH/s = 每秒 1,000 哈希运算
- 1 MH/s = 每秒 1,000,000 次哈希运算
- 1 GH/s = 每秒 1,000,000,000 次哈希运算
- 1 TH/s = 每秒 1,000,000,000,000 次哈希运算
- 1 PH/s = 每秒 1,000,000,000,000,000 次哈希运算
- 1 EH/s = 每秒 1,000,000,000,000,000,000 次哈希运算

### 挖矿难度

跟比特币不同，在以太坊系统中每个区块都可能进行难度调整，且在以太坊不同的发展阶段，难度的调整算法也不相同。

难度调整算法:

#### 简单版本：

$D(H) = b + h$

- $b$：基础部分
- $h$：难度部分

#### 复杂版本：

$D(H) \equiv \begin{cases} D_0 & H_i = 0 \\ max(P(H)_{H_d}+x \times s_2)+e & otherwise \end{cases}$

- `D(H)`：本区块的难度

- $P(H)_{H_d}+x \times s_2$：基础难度

    - $P(H)_{H_d}$：父区块难度
    - $x \times s_2$：自适应调节出块难度

- $e$：难度炸弹，主要用来调节难度；每十万个扩大一倍，是2的指数函数，到了后期增长非常快

    $e \equiv \lfloor 2 \lfloor max(H_i - 3000000, 0) \div 100000 \rfloor - 2\rfloor$

    - $max(H_i - 3000000, 0)$：fake block number，由真正的block number减少到三百万得到;这样做的原因是低估了PoS协议的开发难度，属于历史遗留问题

- $D0$：最小值，即下限；131072

- $x$：父区块的难度除以2048后向下取整

    $x \equiv \lfloor \frac{P(H)_{H_d}}{2048} \rfloor$
    
- $s_2$：当父区块中包含了叔父uncle区块时，y为2，否则为1。

    $s_2=max(y-\lfloor \frac{H_s - P(H)_{H_s}}{9} \rfloor, -99)$

    - $H_s$：本区块的时间戳，单位秒
    - $P(H)_{H_s}$：父区块的时间戳，单位秒
    - $-99$：难度降低的上界，设置为-99主要是为了应对黑客攻击或其他异常情况

**真正决定难度的地方在于：$x \times s_2$（自适应调节出块难度）和$e$（难度炸弹），其他部分都是相对固定的值。**

挖矿难度分级：

todo

当前的挖矿难度：

todo

### 以太币的产生

以太币的供给分为以下几种：

- 初始代币

    以太坊项目创建时，分配给创始人团队及其他人的奖励；项目创建就有了，总量大概7200万；

- 增发代币

    - 固定奖励

        1. 块奖励

            最初，以太坊设定的固定奖励是：每个区块获得5个ETH。经过2次修改（2017年10月修改为3个ETH，2019年3月修改为2个ETH），目前为每个区块获得2个ETH。

        2. 区块内包含的所有程序的Gas花费的总和

        3. 如果普通块包含了叔块，每包含一个叔块可以得到固定奖励(2ETH)的$\frac {1}{32}$

    - 叔块奖励

        $r = \frac {(h + 8 - H_u) \times R_b}{8}$

        - $r$： 叔块奖励
        - $h$：叔块高度
        - $H_u$：包含叔块的区块的高度
        - $R_b$：普通区块奖励

### 以太坊价格

来源[Coinbase](https://www.coinbase.com/)

| 更新时间          | 报价（美元） |
| ----------------- | ------------ |
| 20210516-16:11:00 | `$3819.89`   |
|                   |              |

### 一些常见硬件的算力及功率

来源

| 硬件           | 算力                               | 功率 |
| -------------- | ---------------------------------- | ---- |
| NVIDIA-RTX3090 | 120～122 MH/S，尚不知道怎么超频    | 350W |
| NVIDIA-RTX3080 | 73~74 MH/S，超频可达到：92~93 MH/S | 320W |



## 经济模型

### 收益

$I = (I_m \times (1 - O_g - O_s) - W \times P_e) \times H - O_o$

- $I$：收入（单位：元）
- $P_e$：电费价格（单位：元/千瓦时）
- $W$：矿机功率（单位：kw）
- $H$：运行时长（单位：小时）
- $I_m$：每小时挖矿收入（单位：元/小时）
- $O_g$：交易所抽水比例（单位：百分比）
- $O_s$：挖矿软件抽水比例（单位：百分比）
- $Oo$：其他支出（宽带，人工维护...）

举例：

假设一台功率为0.35kw的机器1小时收入30元，电费0.6元一度，交易所抽水`0.1%`，不考虑宽带，挖矿软件抽水，维护等其他支出，运行一个月的收入如下:

$(30 \times (1 - 0.01) - 0.35 \times 0.6) \times 24 \times 30 = $ ? 元



## 成本分析

一台矿机器的成本构成由一次性投入和长期性投入两部分构成：

- 一次性投入：

    价格参考自[京东](https://www.jd.com/)
    
    | 支出项目       | 型号                | 金额      |
	| -------------- | ------------------- | --------- |
	| 显卡           | RTX 3090<br>        | 26000<br> |
	| 机柜+主板+电源 | 8显卡台式机矿机<br> | 2368<br>  |

- 长期性投入：

	| 支出项目       | 金额      |
	| -------------- | --------- |
	| 电费           | 0.6 元/度 |
	| 带宽           | 100 元/月 |
	| 其他维护性费用 | -         |

举例：

搭建一台配置为：

- 显卡:：RTX 3090
- 其它：

的矿机需要一次性投入：28368元；

按照每小时收入3元计算，不考虑人工，维修，宽带等支出，收益曲线如表：

| 时长（月） | 累计收入（元） |
| ---------- | -------------- |
| 1          | 1447.2         |
| 2          | 2894.4         |
| 3          | 4341.6         |
| 4          | 5788.8         |
| 5          | 7236           |
| 6          | 8683.2         |
| 7          | 10130.4        |
| 8          | 11577.6        |
| 9          | 13024.8        |
| 10         | 14472          |
| 11         | 15919.2        |
| 12         | 17366.4        |
| 13         | 18813.6        |
| 14         | 20260.8        |
| 15         | 21708          |
| 16         | 23155.2        |
| 17         | 24602.4        |
| 18         | 26049.6        |
| 19         | 27496.8        |
| 20         | 28944          |





## 风险和收益

**风险：**

1. eth价格波动

    eth价格的波动会对收益产生明显的影响，目前处于币价顶峰，eth下跌的可能性比较大。

2. 硬件损坏

    长期运行挖矿程序会对矿机硬件造成影响，对设备的管理不善可能会造成矿机的寿命缩短。

3. 法律法规

    目前国家对于数字货币挖矿的态度不甚明朗，同时[断卡行动](https://baijiahao.baidu.com/s?id=1680303982479502247&wfr=spider&for=pc)增加了提取现金的难度。
    
4. 以太坊接下来（预计2022年）可能会升级到2.0协议，挖矿机制可能会变化。

**收益：**

1. 目前币价高涨，这个时候投入进去，收入会比较丰厚。
2. 目前显卡价格高涨，就算挖矿不赚钱，到时候也可以把硬件卖掉，卖掉的钱预计可以回收成本的50%~70%左右。



## 结论

可以先在个人电脑进行测试，确认无误在谨慎投入。