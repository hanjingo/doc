# skynet锁
读写锁，原子操作，自旋锁的实现



## 读写锁

源码中用到了 __sync_synchronize() 内存屏障，主要为了解决gcc的一个乱序执行bug，
（此bug存在于低版本的gcc，高版本已修复）

2种实现锁的方式

1. 使用系统的线程锁

   如果定义了`USE_PTHREAD_LOCK`，使用此方式。

2. 使用`pthread.h`的锁



## 自旋锁

自旋锁是一种互斥锁的实现方式，相比一般的互斥锁会在等待期间放弃cpu，
自旋锁（spinlock）则是不断循环并测试锁的状态，这样就一直占着cpu。

2种实现方式:

1. 使用系统的线程锁

   如果定义了`USE_PTHREAD_LOCK`，使用此方式。
2. 使用`pthread.h`的锁